══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 01:42:06.553903
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 01:42:06.598647
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 18                  
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 2100                
   history_length   │ 5                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 01:41:59.433520+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Traceback (most recent call last):
  File "/home/hujifeng/anaconda3/envs/diffusion_env/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py", line 32, in main
    dataset_config = utils.Config(
  File "/home/hujifeng/workspace/TemporallyComposableDiffuser/diffuser/utils/config.py", line 38, in __init__
    os.mkdir(father_save_path)
FileNotFoundError: [Errno 2] No such file or directory: 'analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-05-24 01:42:06.609243
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 01:42:54.762961
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 01:42:54.819434
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 18                  
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 2100                
   history_length   │ 5                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 01:42:47.670205+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3696 | state_loss:   1.1466 | t:   4.0354
╒════════════════════╤════════════════════╕
│     state loss     │       1.147        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.370        │
├────────────────────┼────────────────────┤
│     ProcessID      │       44860        │
╘════════════════════╧════════════════════╛

1000:   0.0414 | state_loss:   0.1165 | t:  80.7271
╒════════════════════╤════════════════════╕
│     state loss     │       0.116        │
├────────────────────┼────────────────────┤
│       steps        │        1000        │
├────────────────────┼────────────────────┤
│        loss        │       0.041        │
├────────────────────┼────────────────────┤
│     ProcessID      │       44860        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 01:46:29.875701
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 01:46:29.931969
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 18                  
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 2100                
   history_length   │ 5                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 01:46:22.604955+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3696 | state_loss:   1.1466 | t:   3.9941
╒════════════════════╤════════════════════╕
│     state loss     │       1.147        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.370        │
├────────────────────┼────────────────────┤
│     ProcessID      │       45427        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 05:03:53.206024
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 05:03:53.255135
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 2                   
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 0                   
   history_length   │ 1                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 05:03:45.836011+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3680 | state_loss:   1.1230 | regression_loss:   0.2173 | t:   4.2172
╒════════════════════╤════════════════════╕
│     state loss     │       1.123        │
├────────────────────┼────────────────────┤
│  regression loss   │       0.217        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.368        │
├────────────────────┼────────────────────┤
│     ProcessID      │       48163        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 05:06:21.263924
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 05:06:21.319946
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 3                   
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 0                   
   history_length   │ 1                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 05:06:13.920196+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 05:06:53.351211
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 05:06:53.387301
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 3                   
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 0                   
   history_length   │ 1                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 05:06:46.000499+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3785 | state_loss:   1.1859 | quantile_loss:  10.1660 | t:   4.0348
╒════════════════════╤════════════════════╕
│     state loss     │       1.186        │
├────────────────────┼────────────────────┤
│   quantile loss    │       10.166       │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.379        │
├────────────────────┼────────────────────┤
│     ProcessID      │       49143        │
╘════════════════════╧════════════════════╛

1000:   0.0309 | state_loss:   0.0734 | quantile_loss:   0.0861 | t: 110.5942
╒════════════════════╤════════════════════╕
│     state loss     │       0.073        │
├────────────────────┼────────────────────┤
│   quantile loss    │       0.086        │
├────────────────────┼────────────────────┤
│       steps        │        1000        │
├────────────────────┼────────────────────┤
│        loss        │       0.031        │
├────────────────────┼────────────────────┤
│     ProcessID      │       49143        │
╘════════════════════╧════════════════════╛

2000:   0.0321 | state_loss:   0.0873 | quantile_loss:   0.0732 | t: 102.7669
╒════════════════════╤════════════════════╕
│     state loss     │       0.087        │
├────────────────────┼────────────────────┤
│   quantile loss    │       0.073        │
├────────────────────┼────────────────────┤
│       steps        │        2000        │
├────────────────────┼────────────────────┤
│        loss        │       0.032        │
├────────────────────┼────────────────────┤
│     ProcessID      │       49143        │
╘════════════════════╧════════════════════╛

3000:   0.0284 | state_loss:   0.0749 | quantile_loss:   0.0942 | t:  95.0773
╒════════════════════╤════════════════════╕
│     state loss     │       0.075        │
├────────────────────┼────────────────────┤
│   quantile loss    │       0.094        │
├────────────────────┼────────────────────┤
│       steps        │        3000        │
├────────────────────┼────────────────────┤
│        loss        │       0.028        │
├────────────────────┼────────────────────┤
│     ProcessID      │       49143        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 06:17:20.737794
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 06:17:20.792744
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 3                   
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 0                   
   history_length   │ 1                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 06:17:13.495005+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 06:18:06.579261
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 06:18:06.627914
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 4                   
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 0                   
   history_length   │ 1                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 06:17:59.393020+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Traceback (most recent call last):
  File "/home/hujifeng/anaconda3/envs/diffusion_env/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py", line 323, in main
    model = model_config()
  File "/home/hujifeng/workspace/TemporallyComposableDiffuser/diffuser/utils/config.py", line 71, in __call__
    instance = self._class(*args, **kwargs, **self._dict)
  File "/home/hujifeng/workspace/TemporallyComposableDiffuser/diffuser/models/transformer.py", line 255, in __init__
    raise Exception("self.return_type is wrong !!!")
Exception: self.return_type is wrong !!!

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-05-24 06:18:26.278883
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 06:21:17.736354
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 06:21:17.759221
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 4                   
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 0                   
   history_length   │ 1                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 06:21:10.725950+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.4110 | state_loss:   1.3096 | t:   0.1060
╒════════════════════╤════════════════════╕
│     state loss     │       1.310        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.411        │
├────────────────────┼────────────────────┤
│     ProcessID      │       51492        │
╘════════════════════╧════════════════════╛

1000:   0.0348 | state_loss:   0.0912 | t:  24.0352
╒════════════════════╤════════════════════╕
│     state loss     │       0.091        │
├────────────────────┼────────────────────┤
│       steps        │        1000        │
├────────────────────┼────────────────────┤
│        loss        │       0.035        │
├────────────────────┼────────────────────┤
│     ProcessID      │       51492        │
╘════════════════════╧════════════════════╛

2000:   0.0448 | state_loss:   0.1347 | t:  21.3072
╒════════════════════╤════════════════════╕
│     state loss     │       0.135        │
├────────────────────┼────────────────────┤
│       steps        │        2000        │
├────────────────────┼────────────────────┤
│        loss        │       0.045        │
├────────────────────┼────────────────────┤
│     ProcessID      │       51492        │
╘════════════════════╧════════════════════╛

3000:   0.0347 | state_loss:   0.1005 | t:  21.5239
╒════════════════════╤════════════════════╕
│     state loss     │       0.100        │
├────────────────────┼────────────────────┤
│       steps        │        3000        │
├────────────────────┼────────────────────┤
│        loss        │       0.035        │
├────────────────────┼────────────────────┤
│     ProcessID      │       51492        │
╘════════════════════╧════════════════════╛

4000:   0.0368 | state_loss:   0.1080 | t:  20.3915
╒════════════════════╤════════════════════╕
│     state loss     │       0.108        │
├────────────────────┼────────────────────┤
│       steps        │        4000        │
├────────────────────┼────────────────────┤
│        loss        │       0.037        │
├────────────────────┼────────────────────┤
│     ProcessID      │       51492        │
╘════════════════════╧════════════════════╛

5000:   0.0348 | state_loss:   0.1030 | t:  22.9120
╒════════════════════╤════════════════════╕
│     state loss     │       0.103        │
├────────────────────┼────────────────────┤
│       steps        │        5000        │
├────────────────────┼────────────────────┤
│        loss        │       0.035        │
├────────────────────┼────────────────────┤
│     ProcessID      │       51492        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 06:26:48.421463
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 06:26:48.476034
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 5                   
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 0                   
   history_length   │ 1                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 06:26:41.400463+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/hujifeng/anaconda3/envs/diffusion_env/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py", line 336, in main
    batch = utils.batchify(dataset[0], Config.device)
  File "/home/hujifeng/workspace/TemporallyComposableDiffuser/diffuser/datasets/sequence.py", line 376, in __getitem__
    batch = DistQvalueReturnToGoBatch(trajectories, conditions, returns, dones, rewards[:end-start])
TypeError: __new__() missing 1 required positional argument: 'next_obs'

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-05-24 06:27:10.300412
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 06:28:13.099254
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 06:28:13.136478
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 5                   
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 0                   
   history_length   │ 1                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 06:28:05.859288+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3716 | state_loss:   1.1409 | dist_critic_loss:   5.3056 | dist_actor_loss: -75.1498 | t:   3.8527
╒════════════════════╤════════════════════╕
│     state loss     │       1.141        │
├────────────────────┼────────────────────┤
│  dist critic loss  │       5.306        │
├────────────────────┼────────────────────┤
│  dist actor loss   │      -75.150       │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.372        │
├────────────────────┼────────────────────┤
│     ProcessID      │       52829        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 06:32:55.856739
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 06:32:55.905899
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 6                   
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 0                   
   history_length   │ 1                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 06:32:48.601560+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3716 | state_loss:   1.1408 | dist_critic_loss:   5.3058 | dist_actor_loss: -549.5684 | t:   3.9440
╒════════════════════╤════════════════════╕
│     state loss     │       1.141        │
├────────────────────┼────────────────────┤
│  dist critic loss  │       5.306        │
├────────────────────┼────────────────────┤
│  dist actor loss   │      -549.568      │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.372        │
├────────────────────┼────────────────────┤
│     ProcessID      │       53413        │
╘════════════════════╧════════════════════╛

1000:   0.0298 | state_loss:   0.0712 | dist_critic_loss:   5.2892 | dist_actor_loss: -546.0915 | t:  97.0559
╒════════════════════╤════════════════════╕
│     state loss     │       0.071        │
├────────────────────┼────────────────────┤
│  dist critic loss  │       5.289        │
├────────────────────┼────────────────────┤
│  dist actor loss   │      -546.091      │
├────────────────────┼────────────────────┤
│       steps        │        1000        │
├────────────────────┼────────────────────┤
│        loss        │       0.030        │
├────────────────────┼────────────────────┤
│     ProcessID      │       53413        │
╘════════════════════╧════════════════════╛

2000:   0.0338 | state_loss:   0.0926 | dist_critic_loss:   5.2779 | dist_actor_loss: -546.1776 | t:  93.6103
╒════════════════════╤════════════════════╕
│     state loss     │       0.093        │
├────────────────────┼────────────────────┤
│  dist critic loss  │       5.278        │
├────────────────────┼────────────────────┤
│  dist actor loss   │      -546.178      │
├────────────────────┼────────────────────┤
│       steps        │        2000        │
├────────────────────┼────────────────────┤
│        loss        │       0.034        │
├────────────────────┼────────────────────┤
│     ProcessID      │       53413        │
╘════════════════════╧════════════════════╛

3000:   0.0294 | state_loss:   0.0779 | dist_critic_loss:   5.2652 | dist_actor_loss: -546.9114 | t:  88.9278
╒════════════════════╤════════════════════╕
│     state loss     │       0.078        │
├────────────────────┼────────────────────┤
│  dist critic loss  │       5.265        │
├────────────────────┼────────────────────┤
│  dist actor loss   │      -546.911      │
├────────────────────┼────────────────────┤
│       steps        │        3000        │
├────────────────────┼────────────────────┤
│        loss        │       0.029        │
├────────────────────┼────────────────────┤
│     ProcessID      │       53413        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 06:49:02.200196
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 06:49:02.258186
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 7                   
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 0                   
   history_length   │ 1                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 06:48:54.782258+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Testing forward... Traceback (most recent call last):
  File "/home/hujifeng/anaconda3/envs/diffusion_env/lib/python3.8/site-packages/ml_logger/__init__.py", line 203, in thunk
    results = fn(*(args or ARGS), **_KWARGS)
  File "/home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py", line 344, in main
    loss, infos = diffusion.loss(x=batch.trajectories, cond=batch.conditions, returns=batch.returns_timesteps)
  File "/home/hujifeng/workspace/TemporallyComposableDiffuser/diffuser/models/diffusion.py", line 621, in loss
    diffuse_loss, info = self.p_losses(x[:, :, self.action_dim:], cond, t, returns, goals)
  File "/home/hujifeng/workspace/TemporallyComposableDiffuser/diffuser/models/diffusion.py", line 586, in p_losses
    x_recon = self.model(x_noisy, cond, t, returns, goals=goals)
  File "/home/hujifeng/anaconda3/envs/diffusion_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/hujifeng/workspace/TemporallyComposableDiffuser/diffuser/models/temporal.py", line 264, in forward
    x = resnet(x, t)
  File "/home/hujifeng/anaconda3/envs/diffusion_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/hujifeng/workspace/TemporallyComposableDiffuser/diffuser/models/temporal.py", line 102, in forward
    out = self.blocks[0](x) + self.time_mlp(t)
  File "/home/hujifeng/anaconda3/envs/diffusion_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/hujifeng/workspace/TemporallyComposableDiffuser/diffuser/models/helpers.py", line 68, in forward
    return self.block(x)
  File "/home/hujifeng/anaconda3/envs/diffusion_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/hujifeng/anaconda3/envs/diffusion_env/lib/python3.8/site-packages/torch/nn/modules/container.py", line 139, in forward
    input = module(input)
  File "/home/hujifeng/anaconda3/envs/diffusion_env/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/hujifeng/anaconda3/envs/diffusion_env/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 307, in forward
    return self._conv_forward(input, self.weight, self.bias)
  File "/home/hujifeng/anaconda3/envs/diffusion_env/lib/python3.8/site-packages/torch/nn/modules/conv.py", line 303, in _conv_forward
    return F.conv1d(input, weight, bias, self.stride,
RuntimeError: Given groups=1, weight of size [128, 17, 5], expected input[1, 18, 100] to have 17 channels, but got 18 channels instead

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       status       │ errored             
     errorTime      │ 2023-05-24 06:49:24.391778
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 06:51:49.370800
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 06:51:49.427386
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 7                   
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 0                   
   history_length   │ 1                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 06:51:42.331949+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3713 | state_loss:   1.1372 | t:   4.0733
╒════════════════════╤════════════════════╕
│     state loss     │       1.137        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.371        │
├────────────────────┼────────────────────┤
│     ProcessID      │       54707        │
╘════════════════════╧════════════════════╛

1000:   0.0295 | state_loss:   0.0685 | t: 120.3915
╒════════════════════╤════════════════════╕
│     state loss     │       0.069        │
├────────────────────┼────────────────────┤
│       steps        │        1000        │
├────────────────────┼────────────────────┤
│        loss        │       0.029        │
├────────────────────┼────────────────────┤
│     ProcessID      │       54707        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 06:56:34.563013
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 06:56:34.604487
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 7                   
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 0                   
   history_length   │ 1                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 06:56:27.501739+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3713 | state_loss:   1.1372 | t:   4.0052
╒════════════════════╤════════════════════╕
│     state loss     │       1.137        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.371        │
├────────────────────┼────────────────────┤
│     ProcessID      │       55321        │
╘════════════════════╧════════════════════╛

1000:   0.0292 | state_loss:   0.0672 | t: 114.3441
╒════════════════════╤════════════════════╕
│     state loss     │       0.067        │
├────────────────────┼────────────────────┤
│       steps        │        1000        │
├────────────────────┼────────────────────┤
│        loss        │       0.029        │
├────────────────────┼────────────────────┤
│     ProcessID      │       55321        │
╘════════════════════╧════════════════════╛

══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
    script_path     │ None                
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
      counter       │ 2                   
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        name        │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
       status       │ created             
     createTime     │ 2023-05-24 07:13:45.040701
════════════════════╧═════════════════════
[33m      revision      [0m
────────────────────┬─────────────────────
        hash        │ None                
       branch       │ None                
════════════════════╧═════════════════════
[33m         fn         [0m
────────────────────┬─────────────────────
        name        │ main                
        doc         │ None                
       module       │ scripts.train       
        file        │ /home/hujifeng/workspace/TemporallyComposableDiffuser/scripts/train.py
════════════════════╧═════════════════════
[33m        args        [0m
────────────────────┬─────────────────────
()
════════════════════╧═════════════════════
[33m       kwargs       [0m
────────────────────┬─────────────────────
     RUN.prefix     │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
        seed        │ 100                 
  predict_epsilon   │ True                
 n_diffusion_steps  │ 200                 
 condition_dropout  │ 0.25                
   n_train_steps    │ 1000000.0           
   returns_scale    │ 400.0               
  RUN.job_counter   │ 1                   
    RUN.job_name    │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
════════════════════╧═════════════════════
taking diff, if this step takes too long, check if your uncommitted changes are too large.
not storing the git diff due to Command 'cd "/home/hujifeng/workspace/TemporallyComposableDiffuser" && git diff HEAD --binary' returned non-zero exit status 1.
══════════════════════════════════════════
[33m        job         [0m
────────────────────┬─────────────────────
       job_id       │ None                
       status       │ started             
     startTime      │ 2023-05-24 07:13:45.099023
════════════════════╧═════════════════════
[33m        host        [0m
────────────────────┬─────────────────────
      hostname      │ server5             
════════════════════╧═════════════════════
══════════════════════════════════════════
[33m       Config       [0m
────────────────────┬─────────────────────
        seed        │ 100                 
       device       │ cuda                
       bucket       │ analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/
      dataset       │ walker2d-expert-v2  
       model        │ models.TemporalUnet 
 transformer_model  │ models.Transformer  
behavior_cloning_model│ models.BC           
     diffusion      │ models.GaussianInvDynDiffusion
behavior_cloning_diffusion│ models.BehaviorCloningDiffusion
      horizon       │ 100                 
 n_diffusion_steps  │ 200                 
   action_weight    │ 10                  
    loss_weights    │ None                
   loss_discount    │ 1                   
  predict_epsilon   │ True                
     dim_mults      │ (1, 4, 8)           
 returns_condition  │ True                
    calc_energy     │ False               
        dim         │ 128                 
 condition_dropout  │ 0.25                
condition_guidance_w│ 1.2                 
      test_ret      │ 0.9                 
      renderer      │ utils.MuJoCoRenderer
       loader       │ datasets.SequenceDataset
     normalizer     │ CDFNormalizer       
   preprocess_fns   │ []                  
   clip_denoised    │ True                
    use_padding     │ True                
  include_returns   │ True                
    return_type     │ 8                   
traj_length_must_bigger_than│ 100                 
traj_return_must_bigger_than│ None                
    top_K_length    │ 1                   
max_trajectory_return_offset│ 0                   
   history_length   │ 5                   
distance_to_failure_obs│ 0                   
transformer_hidden_dim│ 256                 
 sample_trajectory  │ 3                   
   srs_inv_model    │ False               
      discount      │ 0.99                
  max_path_length   │ 1000                
     hidden_dim     │ 256                 
       ar_inv       │ False               
   train_only_inv   │ False               
termination_penalty │ -100                
   returns_scale    │ 400.0               
 n_steps_per_epoch  │ 10000               
     loss_type      │ l2                  
   n_train_steps    │ 1000000.0           
     batch_size     │ 32                  
   learning_rate    │ 0.0002              
gradient_accumulate_every│ 2                   
     ema_decay      │ 0.995               
      log_freq      │ 1000                
     save_freq      │ 10000               
     save_range     │ [100000, 900000]    
     eval_step      │ 100000              
    sample_freq     │ 10000               
      n_saves       │ 5                   
   save_parallel    │ False               
    n_reference     │ 8                   
  save_checkpoints  │ False               
 bisimulation_model │ models.Bisimulation_Model
return_based_state_to_goal│ models.Return_based_State_to_Goal_Model
goal_conditional_generation│ False               
   goal_distance    │ 1                   
include_goal_returns│ False               
  goals_condition   │ False               
general_goal_prediction│ False               
diffusion_goal_prediction│ True                
 wandb_project_name │ diffusion_offline   
     wandb_log      │ False               
wandb_log_frequency │ 1000                
     reset_seed     │ False               
reward_linear_regression_model│ models.Linear_Regression_Model
reward_quantile_regression_model│ models.Quantile_Regression_Model
q_distribution_model│ models.Categorical_Q_Function
════════════════════╧═════════════════════
[33m        RUN         [0m
────────────────────┬─────────────────────
       server       │ /home/hujifeng/workspace/TemporallyComposableDiffuser
      username      │ hujifeng            
      project       │ diffuser            
    script_root     │ /home/hujifeng/workspace/TemporallyComposableDiffuser/analysis
    script_path     │ None                
        now         │ 2023-05-24 07:13:37.758522+00:00
       prefix       │ diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
      job_name      │ predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
    job_counter     │ 1                   
       resume       │ True                
       readme       │ None                
       debug        │ False               
CUDA_VISIBLE_DEVICES│ None                
     file_stem      │                     
════════════════════╧═════════════════════
Testing forward... ✓
Epoch 0 / 100 | diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100
[ utils/training ] Saved model to analysis/code/model_data/walker2d_e_HC_5_FAR_unify_range_RTG_multi_checkpoints_RT18/diffuser/default_inv/predict_epsilon_200_1000000.0/dropout_0.25/hopper-medium-expert-v2/100/checkpoint/state.pt
0:   0.3696 | state_loss:   1.1466 | t:   4.0714
╒════════════════════╤════════════════════╕
│     state loss     │       1.147        │
├────────────────────┼────────────────────┤
│       steps        │         0          │
├────────────────────┼────────────────────┤
│        loss        │       0.370        │
├────────────────────┼────────────────────┤
│     ProcessID      │       56625        │
╘════════════════════╧════════════════════╛

1000:   0.0415 | state_loss:   0.1167 | t:  76.1717
╒════════════════════╤════════════════════╕
│     state loss     │       0.117        │
├────────────────────┼────────────────────┤
│       steps        │        1000        │
├────────────────────┼────────────────────┤
│        loss        │       0.041        │
├────────────────────┼────────────────────┤
│     ProcessID      │       56625        │
╘════════════════════╧════════════════════╛

